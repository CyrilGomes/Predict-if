<!DOCTYPE html>
<html>
    <head>
        <title>Tableau de Bord Employé</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="main.css">
        <!-- Librairie Javascript: jQuery (v3.4.1) -->
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    </head>
    <body>

        <!-- HEADER -->
        <div class="header">
            <a href="index.html" class="logo">Predict'IF</a>
            <div class="header-right">
                <a href="#" id="boutonConsultationEnCours">Consultation en cours</a>
                <a href="#" id="boutonTableauDeBord">Tableau de Bord</a>
                <a href="#" id="boutonProfil">Profil</a>
            </div>
        </div>

        <script>
            $(document).ready(function () {

            /* INITIALISATION */

            // REDIRIGER VERS UNE AUTRE PAGE SI CE N'EST PAS LE BON USER 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'obtenirUtilisateurCourant'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // Si l'utilisateur n'est pas loggé ou qu'il n'est pas un employé...
                if (!(response.utilisateur && response.type == "employe")) {
                    // Rediriger vers l'accueil
                    window.location.replace("index.html");
                }
            })
            .fail(function (error) {
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            
            /*
            // OBTENIR CONSULTATION ATTRIBUEE 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'obtenirConsultationAttribuee'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // Si une consultation a été attribuée à l'utilisateur courant...
                if (response.consultation) {
                    // Populer un div avec les informations de la consultation en cours et le montrer
                    // TODO
                }
            })
            .fail(function (error) { 
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            */
            
            /*
            // OBTENIR STATISTIQUES 1 (mediums et leurs clients) 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'genererStatistiquesMediums'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // TODO: populer/générer le graphique 1 avec les informations statistiques et le montrer (piechart de mediums)
            })
            .fail(function (error) { 
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            
            // OBTENIR STATISTIQUE 2 (employes et leurs clients) 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'genererStatistiquesRepartitionClientsParEmploye'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // TODO: populer/générer le graphique 2 avec les informations statistiques et le montrer (histogramme d'employés)
            })
            .fail(function (error) { 
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            
            // OBTENIR STATISTIQUE 3 (mediums les plus populaires) 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'genererStatistiquesMediumsPopulaires'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // TODO: populer/générer le graphique 3 avec les informations statistiques et le montrer (histogramme de médiums)
            })
            .fail(function (error) { 
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            
            // OBTENIR STATISTIQUE 4 (clients et leurs temps d'appel) 
            // Appel AJAX
            $.ajax({
            url: './ActionServlet',
                    method: 'POST',
                    data: {
                        todo: 'genererStatistiquesTempsAppelClients'
                    },
                    dataType: 'json'
            })
            .done(function (response) { 
                console.log('Response', response);
                // TODO: populer/générer le graphique 4 avec les informations statistiques et le montrer (histogramme de clients)
            })
            .fail(function (error) { 
                console.log('Error', error);
                alert("Erreur lors de l'appel AJAX");
            })
            .always(function () { 
            });
            */
                    
            /* SERVICE signalerDebutConsultation */
            $('#bouton-je-suis-pret').on('click', function () {
                // Appel AJAX
                $.ajax({
                url: './ActionServlet',
                        method: 'POST',
                        data: {
                            todo: 'signalerDebutConsultation'
                        },
                        dataType: 'json'
                })
                .done(function (response) {
                    console.log('Response', response);
                    // TODO: rediriger vers la page Consultation en Cours
                })
                .fail(function (error) { 
                    console.log('Error', error);
                    alert("Erreur lors de l'appel AJAX");
                })
                .always(function () { 
                });
            });
            
            });
        </script>

    </body>
</html>
